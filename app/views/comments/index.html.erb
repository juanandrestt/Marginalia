<div class="container mt-4">
<div class="mb-3">
    <%= link_to "← Back to Book", book_path(@review.book), class: "btn btn-outline-dark rounded-pill px-4", style: "color: #751F1F; border-color: #751F1F;" %>
  </div>
  <h2 class="mb-4" style="color: #751F1F;">Comments for Review</h2>

  <!-- Review Content -->
  <div class="mb-4 p-4 shadow-sm rounded-5" style="background-color: #F5EADB;">
    <p><strong>Review:</strong> <%= @review.content %></p>
    <p><strong>Rating:</strong> <%= @review.rating %>/5</p>
    <p><strong>Emotion:</strong> <%= @review.emotion %></p>
    <p><strong>Favorite Characters:</strong> <%= @review.favorite_characters %></p>
  </div>

  <!-- Comments Section -->
  <div class="comments-section">
    <h4 class="mb-3" style="color: #751F1F;">Comments</h4>
    <% @comments.each do |comment| %>
      <div class="mb-3 p-3 shadow-sm rounded-5" style="background-color: #F5EADB;">
        <div class="d-flex align-items-center gap-2 mb-2">
          <img src="<%= comment.user.avatar %>"
               alt="<%= comment.user.username || comment.user.email %>"
               class="rounded-circle"
               style="width: 30px; height: 30px; object-fit: cover;">
          <div>
            <p class="mb-0 fw-bold" style="color: #751F1F;"><%= comment.user.username || comment.user.email %></p>
            <p class="mb-0 text-muted" style="font-size: 14px;"><%= comment.content %></p>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Add Comment Form -->
  <div class="mt-4">
    <%= form_with model: [@review, @comment], local: true do |f| %>
      <div class="d-flex gap-2">
        <%= f.text_field :content, placeholder: "Add a comment...", class: "form-control rounded-pill", style: "flex: 1;" %>
        <%= f.submit "Comment", class: "btn btn-primary rounded-pill" %>
      </div>
    <% end %>
  </div>
</div>
