<div class="container mt-4 mb-4">
  <div class="mb-3">
    <%= link_to "←", :back, class: "btn btn-outline-dark rounded-pill px-4", style: "color: #751F1F; border-color: #751F1F;" %>
  </div>
  <!-- Book Cover -->
  <div class="text-center mb-4">
    <img src="<%= @book.cover_url %>" alt="<%= @book.title %>" class="img-fluid shadow rounded" style="max-height: 280px; object-fit: cover;">
  </div>

  <!-- Title & Author -->
  <div class="text-center mb-3">
    <h2 class="fw-bold" style="color: #751F1F;">
      <%= @book.title %>
      <% if @book.readings.exists?(user: current_user) %>
        <i class="fa-solid fa-book-bookmark"></i>
      <% end %>
    </h2>
    <p class="text-muted" style="margin-top: -0.5rem;"><%= @book.author %></p>
  </div>

  <!-- Description bloc styled -->

  <div class="mb-4 px-2 text-center">
    <p class="text-muted mb-2" style="font-size: 14px;"><%= @book.description %></p>
    <span class="badge bg-light border text-muted rounded-pill px-3">
      <%= @book.publishing_year %>
    </span>
    <div class="d-flex justify-content-center gap-3 mb-2" style="font-size: 13px;">
      <% if @book.subjects.present? %>
        <% @book.subjects.split(',')[1..2]&.each do |tag| %>
          <span class="badge bg-light border text-muted rounded-pill px-3">
            <%= tag.strip %>
          </span>
        <% end %>
      <% end %>
    </div>
    <% if @book.characters.present? %>
      <div class="mt-2 text-muted" style="font-size: 13px;">
        <strong>Characters:</strong> <%= @book.characters %>
      </div>
    <% end %>
  </div>
  <!-- CTA Buttons -->
  <% if @book.characters.present? %>
    <div class="mt-2 text-muted" style="font-size: 13px;">
      <strong>Characters:</strong> <%= @book.characters %>
    </div>
  <% end %>

</div>
<div class="d-flex justify-content-center gap-2 mt-4 mb-5">
  <div>
    <% if user_signed_in? && !@current_user_review %>
      <%= link_to new_book_review_path(@book), class: "btn btn-outline-dark rounded-pill px-4", style: "color: #751F1F; border-color: #751F1F;" do %>
        <i class="fas fa-plus"></i> Add a review
      <% end %>
    <% end %>
  </div>
  <!-- CTA bookclub -->
  <div>
    <%= link_to new_book_bookclub_path(@book), class: "btn btn-outline-dark rounded-pill px-4", style: "color: #751F1F; border-color: #751F1F;" do %>
      <i class="fas fa-plus"></i> Create a bookclub
    <% end %>
  </div>
  </div>
  <!-- Reviews -->
  <div class="container">
    <%= render 'reviews/current_user_review', current_user_review: @current_user_review, book: @book %>
    <h4 class="mb-3" style="color: #751F1F;">Les critiques des lecteurs</h4>
    <% @reviews.each do |review| %>
      <%= render 'reviews/review_card', review: review %>
    <% end %>
  </div>
</div>
